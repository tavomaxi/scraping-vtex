name: Portsaid Catalog Scraper

on:
  schedule:
    # Ejecutar todos los días a las 8:00 AM UTC
    - cron: '0 8 * * *'
  
  # Permitir ejecución manual
  workflow_dispatch:

jobs:
  scrape:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Run scraper
      run: python src/scraper.py --output output
    
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      with:
        name: catalogo-portsaid
        path: output/*
        retention-days: 30
    
    # Opcional: Subir a Google Drive
    # - name: Upload to Google Drive
    #   uses: adityak74/google-drive-upload-git-action@main
    #   with:
    #     credentials: ${{ secrets.GOOGLE_CREDENTIALS }}
    #     filename: output/*.xlsx
    #     folderId: ${{ secrets.GOOGLE_DRIVE_FOLDER_ID }}
    
    # Opcional: Enviar por email
    # - name: Send email
    #   uses: dawidd6/action-send-mail@v3
    #   with:
    #     server_address: smtp.gmail.com
    #     server_port: 587
    #     username: ${{ secrets.EMAIL_USERNAME }}
    #     password: ${{ secrets.EMAIL_PASSWORD }}
    #     subject: Catálogo Portsaid - ${{ github.run_id }}
    #     to: destinatario@email.com
    #     from: ${{ secrets.EMAIL_USERNAME }}
    #     attachments: output/*.xlsx
